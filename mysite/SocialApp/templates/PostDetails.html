{% extends "base.html" %}

{% load static %}
{% load app_filters %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/postdetails.css' %}">
{% endblock %}

{% block content %}

{% load markdownify %}

    <div class="posti">
        <h1>{{ post.title }}</h1>
            <p><small>By: {{ post.author }}</small></p>

            <section>
                {% if post.content_type == "text/plain" %}
                <!--display a post as text without formatting-->
                    <p>{{post.content}}</p>
                {% elif post.content_type == "text/markdown" %}
                <!--render markdown post as sanitized html-->
                    {{post.content|markdownify}}
                {% elif post.content_type == "application/base64" %}
                <!--assume this image has full base64 encoding, not just payload-->
                    <img alt="post image" src={{ post.content }}>
                {% else %}
                <!--display base64 data as an image - prepend stored content type-->
                    <img alt="post image" src={{ "data:"|add:post.content_type|add:","|add:post.content }}>
                {% endif %}
            </section>
        
         <!--COMMENTS-->
         <br><br/>
        <h2 class="comment">COMMENTS </h2>
        
        {% if not post.comment_set.all%}
            <!--No Comments yet <a href="{% url 'add_comment' %}">add comment</a>-->
        {% else %}
            {% for comment in post.comment_set.all%}
                <ul>
                    <small>By: {{comment|comment_author_name}}</small> - <strong>{{comment.comment}}</strong>
                </ul>
                
            {% endfor %}
        {% endif %}
        <a href="{% url 'add_comment'%}">Add Comments</a>
    </div>

{% endblock %}